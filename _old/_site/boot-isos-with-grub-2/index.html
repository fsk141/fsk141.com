
<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>Boot iso's with grub 2</title>
		
		<meta name="author" content="Jonny">
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<!-- HTML5 for IE -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
			<![endif]-->

	    <!-- Style -->
	    <link href="/assets/themes/fsk141/css/bootstrap.min.css" rel="stylesheet">
		<link href="/assets/themes/fsk141/css/bootstrap-responsive.min.css" rel="stylesheet">
		<link href="/assets/themes/fsk141/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
		<link href="/assets/themes/fsk141/css/pygmentize.css" rel="stylesheet">

		<!-- apple icons go here -->
	</head>

	<body>
		<div class="container-fluid">
			<div class="row-fluid">
			  <div class="span3 well">
				<h1><a class="brand" href="/">Fsk141</a></h1>
				<h3 class="h2link"></h2>
				<h3 class="h2link"></h2>
				<h3 class="h2link">


  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
    
  


</h2>
				<br>
				<div class="misc vcard">
					<h4>about</h4>
					<ul>
						<li class="contact"><address><span class="author fn n">Jonny</span> - <span class="fn email">jonny@fsk141.com</span></address></li>
						<li class="rss"><a href="http://feeds.feedburner.com/Fsk141">Subscribe to RSS Feed</a></li>
						<li class="github"><a href="http://github.com/fsk141/" rel="me">github.com/fsk141</a></li>
						<li class="twitter"><a href="http://twitter.com/fsk141/" rel="me">twitter.com/fsk141</a></li>
						<!-- <li class="reddit"><a href="http://reddit.com/user/fsk141/" rel="me">reddit.com/user/fsk141</a></li> -->
						<!-- <li class="flickr"><a href="http://flickr.com/photos/fsk141/" rel="me">flickr.com/photos/fsk141</a></li> -->
						<li class="lastfm"><a href="http://last.fm/user/fsk141/" rel="me">last.fm/user/fsk141</a></li>
						<li class="btc_donate">Donate some btc's:<br />
							<span style="font-size: 0.5em;">
							<script src="http://coinwidget.com/widget/coin.js"></script>
							<script>
							CoinWidgetCom.go({
								wallet_address: "1ByZeEBE2wtUabcAhgPEp7yjttFJJZWDdT"
								, currency: "bitcoin"
								, counter: "count"
								, alignment: "bl"
								, qrcode: true
								, auto_show: false
								, lbl_button: "Donate"
								, lbl_address: "BTC Address:"
								, lbl_count: "donations"
								, lbl_amount: "BTC"
							});
							</script>
							</span></li>
					</ul>
					<ul class="tag_box inline">
						
						


  
     
    	<li><a href="/categories.html#programming-ref">
    		programming <span>11</span>
    	</a></li>
     
    	<li><a href="/categories.html#software-ref">
    		software <span>16</span>
    	</a></li>
     
    	<li><a href="/categories.html#zfs-ref">
    		zfs <span>4</span>
    	</a></li>
     
    	<li><a href="/categories.html#linux-ref">
    		linux <span>50</span>
    	</a></li>
     
    	<li><a href="/categories.html#opensolaris-ref">
    		opensolaris <span>9</span>
    	</a></li>
     
    	<li><a href="/categories.html#networking-ref">
    		networking <span>9</span>
    	</a></li>
     
    	<li><a href="/categories.html#hardware-ref">
    		hardware <span>9</span>
    	</a></li>
     
    	<li><a href="/categories.html#homebrew-ref">
    		homebrew <span>3</span>
    	</a></li>
     
    	<li><a href="/categories.html#other stuff-ref">
    		other stuff <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#tutorials-ref">
    		tutorials <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#mac-ref">
    		mac <span>3</span>
    	</a></li>
     
    	<li><a href="/categories.html#photography-ref">
    		photography <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#kindle-ref">
    		kindle <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#reviews-ref">
    		reviews <span>3</span>
    	</a></li>
     
    	<li><a href="/categories.html#bitcoin-ref">
    		bitcoin <span>2</span>
    	</a></li>
    
  


					</ul>
				</div>
				<p>&copy; Jonny 2013 with help from <a href="http://jekyllbootstrap.com">Jekyll Bootstrap</a></p>
			  </div>

			  <div class="offset-1" style="padding-top:20px;">
				  
<div class="">
	<h1>Boot iso's with grub 2 <small></small></h1>
</div>

<div class="row">
  <div class="span8">
    <p>Okay; to prefix this post I just want to say this is AWESOME! I’ve wanted &amp; tried to find a way to do this for years, and guess I didn’t try hard enough; or google very well? I found this the other day, and thought I would share it with the internets…
Firstly install grub2 on your medium you would like to use. Since I’m using this featurette for booting iso’s off of my portable toolkit I’ll show you how to install grub2 on your usb drive.</p>

<p><strong>1) Install grub2 (if you don’t already have it), dosfstools, cfdisk (or just use fdisk or gparted for those gui peoples)</strong></p>

<ul>
  <li>This should do the trick if you are on Arch Linux</li>
</ul>

<div>
    <pre><code class="bash">pacman -S dosfstools grub2</code></pre>
  </div>

<ul>
  <li>Check your repos, or manually compile &amp;&amp; make sure you don’t do any nasty grub1 conflicts</li>
</ul>

<p><strong>2) Format disk with one FAT32 partition</strong></p>

<p>I used fdisk &amp; had no problems</p>

<div>
    <pre><code class="bash">sudo fdisk /dev/sdd</code></pre>
  </div>

<ul>
  <li>
    <p>(sdd == the disk I would like to format) &amp;&amp; make one partition that’s bootable &amp; FAT32 flagged</p>
  </li>
  <li>
    <p>Delete all the partitions first &amp; then create a new one with defaults &amp;&amp; DONT FORGET TO SET THE BOOT FLAG TO ON ( a )</p>
  </li>
</ul>

<div>
    <pre><code class="bash">[~]$ sudo fdisk /dev/sdd

Command (m for help): d
Selected partition 1

Command (m for help): d
No partition is defined yet!

Command (m for help): n
Command action
 e   extended
 p   primary partition (1-4)
p
Partition number (1-4, default 1): 1
First sector (2048-126959615, default 2048):
Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-126959615, default 126959615):
Using default value 126959615

Command (m for help): a
Partition number (1-4): 1

Command (m for help): t
Selected partition 1
Hex code (type L to list codes): b
Changed system type of partition 1 to b (W95 FAT32)

Command (m for help): w
The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.</code></pre>
  </div>

<ul>
  <li>
    <p>d == delete partitions (delete until there aren’t any left)</p>
  </li>
  <li>
    <p>n == create new partition</p>

    <ul>
      <li>
        <p>p == primary</p>
      </li>
      <li>
        <p>1 == partition number</p>
      </li>
      <li>
        <p>First sector (just hit enter; it’s fine how it is)</p>
      </li>
      <li>
        <p>Last sector (just hit enter to use entire disk)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>a == set partition 1 to bootable (this is important)</p>
  </li>
  <li>
    <p>w == write all the changes to disk &amp; quit</p>
  </li>
  <li>
    <p>t == set partition type &amp;&amp; b == FAT32</p>
  </li>
</ul>

<p><strong>3) Add a filesystem</strong></p>

<div>
    <pre><code class="bash">sudo mkfs.vfat -F 32 /dev/sdd1</code></pre>
  </div>

<ul>
  <li>-F 32 == FAT32 &amp;&amp; /dev/sdd1 == the partition you created with cfdisk</li>
</ul>

<p><strong>4) Install grub2</strong></p>

<div>
    <pre><code class="bash">sudo mkdir /mnt/flash

sudo mount /dev/sdd1 /mnt/flash

sudo grub-install --force --no-floppy --root-directory=/mnt/flash /dev/sdd</code></pre>
  </div>

<ul>
  <li>
    <p>make a folder to mount your disk into &amp;&amp; mount it (need this to install grub boot files)</p>
  </li>
  <li>
    <p>–force isn’t necessary, but helps for any un-necessary glitches that don’t matter</p>
  </li>
  <li>
    <p>–no-floppy explicitely prevents floppy emulation (you don’t need it)</p>
  </li>
  <li>
    <p>–root-directory is where you mounted your disk (if you put it somewhere other than /mnt/flash)</p>
  </li>
  <li>
    <p>/dev/sdd is the device node of your device</p>
  </li>
</ul>

<p>Once you hit enter you should be greeted with a sweet little message of success:</p>

<div>
    <pre><code class="bash">Installation finished. No error reported.</code></pre>
  </div>

<p><strong>5) Install a test iso to try out booting from iso</strong></p>

<p>Just an FYI; not all linux iso’s have iso compatibility compiled in, so it’s a hit/miss if this works. You just have to try it, and google around until you find something that works.</p>

<div>
    <pre><code class="bash">cd /mnt/flash

mkdir isos

cd isos

wget http://exo.enarel.eu/mirror/partedmagic/pmagic-5.9.iso

sudo vim /mnt/flash/boot/grub/grub.cfg</code></pre>
  </div>

<ul>
  <li>Now all we need to do is add our parted magic iso features into grub.cfg</li>
</ul>

<div>
    <pre><code class="bash">set timeout=10
set default=0

menuentry &quot;Parted Magic&quot; {
 set isofile=&quot;/isos/pmagic-5.9.iso&quot;

 loopback loop $isofile
 linux (loop)/pmagic/bzImage iso_filename=$isofile edd=off noapic load_ramdisk=1 prompt_ramdisk=0 rwnomce sleep=10 loglevel=0
 initrd (loop)/pmagic/initramfs
}</code></pre>
  </div>

<p><strong>6) ENJOY!</strong></p>

    <hr>

	<h3>Related posts</h3>
	<ul>
		
		  <li><a href="/rtorrent-the-complete-guide">rTorrent -- The complete guide <i>(December 31, 2011)</i></a></li>
		  
		  <li><a href="/kernel-compilation-arch-linux">Kernel Compilation &amp; Arch Linux <i>(March 31, 2009)</i></a></li>
		  
		  <li><a href="/review-pc-engines-alix6e1">[Review] PC-Engines alix6e1 <i>(November 07, 2010)</i></a></li>
		  
		  <li><a href="/zfs-pool-setup-configure">ZFS Pool (Setup &amp; Configure) <i>(November 21, 2009)</i></a></li>
		  
		  <li><a href="/potw-bwm-hg">[PotW] bwm-hg <i>(October 26, 2010)</i></a></li>
		  
		  <li><a href="/arch-linux-on-imac-arch-only">Arch Linux on iMac [Arch Only] <i>(September 21, 2010)</i></a></li>
		  
		  <li><a href="/slow-zfs-zpool">Slow ZFS zpool? <i>(October 06, 2010)</i></a></li>
		  
		  <li><a href="/my-fear-of-mutt-and-why-it-was-all-for-null">My fear of mutt, and why it was all for NULL <i>(October 24, 2011)</i></a></li>
		  
		  <li><a href="/potw-tmux">[PotW] tmux <i>(October 13, 2010)</i></a></li>
		  
		  <li><a href="/tutorial-openvz-debian-zenoss-monitor-your-world">[Tutorial] OpenVZ - Debian - Zenoss (monitor your world) <i>(October 08, 2010)</i></a></li>
		  
	</ul>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/review-noctua-nf-p14-flx" title="[Review] Noctua NF-P14 FLX">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/remove-kde-from-backtrack" title="Remove KDE from Backtrack">Next &rarr;</a></li>
      
      </ul>
    </div>
  </div>

  <div class="">
    <h4>Published</h4>
    <div class="date"><span>17 January 2011</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#fat32-ref">fat32 <span>1</span></a></li>
     
    	<li><a href="/tags.html#grub-ref">grub <span>2</span></a></li>
     
    	<li><a href="/tags.html#grub2-ref">grub2 <span>1</span></a></li>
     
    	<li><a href="/tags.html#iso-ref">iso <span>2</span></a></li>
     
    	<li><a href="/tags.html#parted magic-ref">parted magic <span>1</span></a></li>
     
    	<li><a href="/tags.html#pmagic-ref">pmagic <span>1</span></a></li>
    
  



    </ul>
  
  </div>
</div>

<div class="row">
  <div class="span10 offset2">
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'fsk141'; // required: replace example with your forum shortname
    var disqus_identifier = '600 http://fsk141.com/?p=600';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


			  </div>

		  </div>
	  </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/fsk141/js/jquery.min.js"><\/script>')</script>
    <script src="/assets/themes/fsk141/js/bootstrap.min.js"></script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u=(("https:" == document.location.protocol) ? "https" : "http") + "://analytics.fsk141.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
    g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="http://analytics.fsk141.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->

  </body>
</html>

